generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  schemas  = ["public"]
}

model active_storage_attachments {
  id                   BigInt               @id @default(autoincrement())
  name                 String               @db.VarChar
  record_type          String               @db.VarChar
  record_id            BigInt
  blob_id              BigInt
  created_at           DateTime             @db.Timestamp(6)
  active_storage_blobs active_storage_blobs @relation(fields: [blob_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_c3b3935057")

  @@unique([record_type, record_id, name, blob_id], map: "index_active_storage_attachments_uniqueness")
  @@index([blob_id], map: "index_active_storage_attachments_on_blob_id")
  @@schema("public")
}

model active_storage_blobs {
  id                             BigInt                           @id @default(autoincrement())
  key                            String                           @unique(map: "index_active_storage_blobs_on_key") @db.VarChar
  filename                       String                           @db.VarChar
  content_type                   String?                          @db.VarChar
  metadata                       String?
  service_name                   String                           @db.VarChar
  byte_size                      BigInt
  checksum                       String?                          @db.VarChar
  created_at                     DateTime                         @db.Timestamp(6)
  active_storage_attachments     active_storage_attachments[]
  active_storage_variant_records active_storage_variant_records[]

  @@schema("public")
}

model active_storage_variant_records {
  id                   BigInt               @id @default(autoincrement())
  blob_id              BigInt
  variation_digest     String               @db.VarChar
  active_storage_blobs active_storage_blobs @relation(fields: [blob_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_993965df05")

  @@unique([blob_id, variation_digest], map: "index_active_storage_variant_records_uniqueness")
  @@schema("public")
}

model ar_internal_metadata {
  key        String   @id @db.VarChar
  value      String?  @db.VarChar
  created_at DateTime @db.Timestamp(6)
  updated_at DateTime @db.Timestamp(6)

  @@schema("public")
}

model categories {
  id          BigInt    @id @default(autoincrement())
  name        String?   @db.VarChar
  storage_id  BigInt
  created_at  DateTime  @db.Timestamp(6)
  updated_at  DateTime  @db.Timestamp(6)
  archived    Boolean   @default(false)
  archived_at DateTime? @db.Timestamp(6)
  storages    storages  @relation(fields: [storage_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_8c8584bd5f")
  details     details[]

  @@unique([name, storage_id], map: "index_categories_on_name_and_storage_id")
  @@index([storage_id], map: "index_categories_on_storage_id")
  @@schema("public")
}

model clients {
  id         BigInt     @id @default(autoincrement())
  name       String?    @db.VarChar
  phone      String?    @db.VarChar
  created_at DateTime   @db.Timestamp(6)
  updated_at DateTime   @db.Timestamp(6)
  archived   Boolean    @default(false)
  company_id BigInt?
  companies  companies? @relation(fields: [company_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_db0f958971")
  vehicles   vehicles[]

  @@unique([company_id, phone], map: "index_clients_on_company_id_and_phone")
  @@index([company_id], map: "index_clients_on_company_id")
  @@index([name(ops: raw("gin_trgm_ops"))], map: "index_clients_on_name", type: Gin)
  @@schema("public")
}

model companies {
  id           BigInt        @id @default(autoincrement())
  title        String?       @db.VarChar
  company_type Int?
  city         String?       @db.VarChar
  address      String?       @db.VarChar
  created_at   DateTime      @db.Timestamp(6)
  updated_at   DateTime      @db.Timestamp(6)
  city_ref     String?       @db.VarChar
  address_ref  String?       @db.VarChar
  house_number String?       @db.VarChar
  clients      clients[]
  invitations  invitations[]
  storages     storages[]
  users        users[]
  workspaces   workspaces[]

  @@schema("public")
}

model detail_histories {
  id           BigInt   @id @default(autoincrement())
  action_type  Int?
  count_diff   Int?
  count_result Int?
  comment      String?  @db.VarChar
  user_id      String   @db.Uuid
  detail_id    BigInt
  task_id      BigInt?
  storage_id   BigInt
  created_at   DateTime @db.Timestamp(6)
  updated_at   DateTime @db.Timestamp(6)
  tasks        tasks?   @relation(fields: [task_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_1b86a3ac9e")
  details      details  @relation(fields: [detail_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_2426616090")
  users        users    @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_6c4dcab13f")
  storages     storages @relation(fields: [storage_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_867a758e61")

  @@index([detail_id], map: "index_detail_histories_on_detail_id")
  @@index([storage_id], map: "index_detail_histories_on_storage_id")
  @@index([task_id], map: "index_detail_histories_on_task_id")
  @@index([user_id], map: "index_detail_histories_on_user_id")
  @@schema("public")
}

model details {
  id               BigInt             @id @default(autoincrement())
  name             String?            @db.VarChar
  article          String?            @unique(map: "index_details_on_article") @db.VarChar
  count            Int?
  minimum_count    Int?
  suplier_id       BigInt?
  category_id      BigInt?
  storage_id       BigInt
  created_at       DateTime           @db.Timestamp(6)
  updated_at       DateTime           @db.Timestamp(6)
  archived         Boolean            @default(false)
  archived_at      DateTime?          @db.Timestamp(6)
  sell_price       Decimal?           @db.Decimal
  buy_price        Decimal?           @db.Decimal
  detail_histories detail_histories[]
  storages         storages           @relation(fields: [storage_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_1d3acaa439")
  supliers         supliers?          @relation(fields: [suplier_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_3e6fda7e39")
  categories       categories?        @relation(fields: [category_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_7eb8d15839")

  @@index([category_id], map: "index_details_on_category_id")
  @@index([count], map: "index_details_on_count")
  @@index([storage_id], map: "index_details_on_storage_id")
  @@index([suplier_id], map: "index_details_on_suplier_id")
  @@schema("public")
}

model invitations {
  id         String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  created_at DateTime  @db.Timestamp(6)
  updated_at DateTime  @db.Timestamp(6)
  email      String?   @db.VarChar
  company_id BigInt
  companies  companies @relation(fields: [company_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_f16e5a18d7")

  @@index([company_id], map: "index_invitations_on_company_id")
  @@schema("public")
}

model reports {
  id          BigInt   @id @default(autoincrement())
  job_id      String?  @unique(map: "index_reports_on_job_id") @db.VarChar
  data_errors Json?
  created_at  DateTime @db.Timestamp(6)
  updated_at  DateTime @db.Timestamp(6)

  @@schema("public")
}

model schema_migrations {
  version String @id @db.VarChar

  @@schema("public")
}

model services {
  id                BigInt              @id @default(autoincrement())
  title             String?             @db.VarChar
  description       String?             @db.VarChar
  created_at        DateTime            @db.Timestamp(6)
  updated_at        DateTime            @db.Timestamp(6)
  vehicle_histories vehicle_histories[]

  @@schema("public")
}

model storages {
  id               BigInt             @id @default(autoincrement())
  name             String?            @db.VarChar
  company_id       BigInt
  created_at       DateTime           @db.Timestamp(6)
  updated_at       DateTime           @db.Timestamp(6)
  categories       categories[]
  detail_histories detail_histories[]
  details          details[]
  companies        companies          @relation(fields: [company_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_2d2240b84c")
  supliers         supliers[]

  @@index([company_id], map: "index_storages_on_company_id")
  @@schema("public")
}

model supliers {
  id           BigInt    @id @default(autoincrement())
  name         String?   @db.VarChar
  phone        String?   @db.VarChar
  email        String?   @db.VarChar
  site_url     String?   @db.VarChar
  comment      String?   @db.VarChar
  storage_id   BigInt
  created_at   DateTime  @db.Timestamp(6)
  updated_at   DateTime  @db.Timestamp(6)
  suplier_name String?   @db.VarChar
  archived     Boolean   @default(false)
  archived_at  DateTime? @db.Timestamp(6)
  details      details[]
  storages     storages  @relation(fields: [storage_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_a0f33fc780")

  @@index([storage_id], map: "index_supliers_on_storage_id")
  @@schema("public")
}

model tasks {
  id                BigInt              @id @default(autoincrement())
  title             String?             @db.VarChar
  status            Int
  vehicle_id        BigInt
  created_at        DateTime            @db.Timestamp(6)
  updated_at        DateTime            @db.Timestamp(6)
  detail_histories  detail_histories[]
  vehicles          vehicles            @relation(fields: [vehicle_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_e6342a7e7d")
  vehicle_histories vehicle_histories[]

  @@index([vehicle_id], map: "index_tasks_on_vehicle_id")
  @@schema("public")
}

model uploads {
  id         BigInt   @id @default(autoincrement())
  created_at DateTime @db.Timestamp(6)
  updated_at DateTime @db.Timestamp(6)

  @@schema("public")
}

model users {
  id               String             @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  company_id       BigInt
  role             Int?
  created_at       DateTime           @db.Timestamp(6)
  updated_at       DateTime           @db.Timestamp(6)
  auth_user_id     String             @unique(map: "index_users_on_auth_user_id") @db.Uuid
  status           Int                @default(2)
  email            String?            @unique(map: "index_users_on_email") @db.VarChar
  detail_histories detail_histories[]
  companies        companies          @relation(fields: [company_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_7682a3bdfe")

  @@index([company_id], map: "index_users_on_company_id")
  @@schema("public")
}

model vehicle_histories {
  id         BigInt   @id @default(autoincrement())
  distance   Int?
  status     String?  @db.VarChar
  task_id    BigInt
  created_at DateTime @db.Timestamp(6)
  updated_at DateTime @db.Timestamp(6)
  service_id BigInt
  services   services @relation(fields: [service_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_077266b3b2")
  tasks      tasks    @relation(fields: [task_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_bac9cf93bb")

  @@index([service_id], map: "index_vehicle_histories_on_service_id")
  @@index([task_id], map: "index_vehicle_histories_on_task_id")
  @@schema("public")
}

model vehicle_makes {
  id                BigInt           @id @default(autoincrement())
  vehicle_make_id   BigInt           @unique(map: "index_vehicle_makes_on_vehicle_make_id")
  vehicle_make_name String           @db.VarChar
  vehicle_type      Int
  created_at        DateTime         @db.Timestamp(6)
  updated_at        DateTime         @db.Timestamp(6)
  vehicle_models    vehicle_models[]
  vehicles          vehicles[]

  @@schema("public")
}

model vehicle_models {
  id                 BigInt        @id @default(autoincrement())
  vehicle_model_id   BigInt        @unique(map: "index_vehicle_models_on_vehicle_model_id")
  vehicle_model_name String        @db.VarChar
  vehicle_type       Int
  vehicle_make_id    BigInt
  created_at         DateTime      @db.Timestamp(6)
  updated_at         DateTime      @db.Timestamp(6)
  vehicle_makes      vehicle_makes @relation(fields: [vehicle_make_id], references: [vehicle_make_id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_d0bef20deb")
  vehicles           vehicles[]

  @@index([vehicle_make_id], map: "index_vehicle_models_on_vehicle_make_id")
  @@schema("public")
}

model vehicles {
  id                   BigInt          @id @default(autoincrement())
  vehicle_year         Int
  vehicle_distance     Int?
  vehicle_number       String?         @unique(map: "index_vehicles_on_vehicle_number") @db.VarChar
  vehicle_vin_code     String?         @db.VarChar
  vehicle_transmission String?         @db.VarChar
  client_id            BigInt
  created_at           DateTime        @db.Timestamp(6)
  updated_at           DateTime        @db.Timestamp(6)
  vehicle_type         Int?
  vehicle_make_id      BigInt?
  vehicle_model_id     BigInt?
  vehicle_make_name    String?         @db.VarChar
  vehicle_model_name   String?         @db.VarChar
  archived             Boolean         @default(false)
  tasks                tasks[]
  clients              clients         @relation(fields: [client_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_71757241f0")
  vehicle_models       vehicle_models? @relation(fields: [vehicle_model_id], references: [vehicle_model_id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_83f60c4d50")
  vehicle_makes        vehicle_makes?  @relation(fields: [vehicle_make_id], references: [vehicle_make_id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_ebbfd13f29")

  @@index([client_id], map: "index_vehicles_on_client_id")
  @@index([vehicle_distance], map: "index_vehicles_on_vehicle_distance")
  @@index([vehicle_make_id], map: "index_vehicles_on_vehicle_make_id")
  @@index([vehicle_model_id], map: "index_vehicles_on_vehicle_model_id")
  @@index([vehicle_year], map: "index_vehicles_on_vehicle_year")
  @@schema("public")
}

model workspaces {
  id         BigInt    @id @default(autoincrement())
  title      String?   @db.VarChar
  company_id BigInt
  number     Int?
  created_at DateTime  @db.Timestamp(6)
  updated_at DateTime  @db.Timestamp(6)
  companies  companies @relation(fields: [company_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_rails_722962e7d3")

  @@index([company_id], map: "index_workspaces_on_company_id")
  @@schema("public")
}
